---
import { Icon } from "astro-icon/components";
import type {
  ServiceDetailFeature,
  ServiceDetailHighlight,
} from "../../../types/components";

interface Props {
  icon: string;
  title: string;
  description: string;
  imagePosition: "left" | "right";
  features: ServiceDetailFeature[];
  highlights: ServiceDetailHighlight[];
  ctaText: string;
  ctaHref: string;
  isLast?: boolean;
}

const {
  icon,
  title,
  description,
  imagePosition,
  features,
  highlights,
  ctaText,
  ctaHref,
  isLast = false,
} = Astro.props;
---

<div class:list={["service-detail-section", { "service-detail-section--last": isLast }]}>
  <div
    class:list={[
      "service-detail-grid",
      { "service-detail-grid--reverse": imagePosition === "right" },
    ]}
  >
    <!-- Grade de destaques -->
    <div class:list={["highlights-wrapper", { "order-1": imagePosition === "left", "order-2": imagePosition === "right" }]}>
      <div class="highlights-grid">
        {
          highlights.map((highlight) => (
            <div
              class:list={[
                "highlight-card",
                { "highlight-card--full": highlight.fullWidth },
              ]}
            >
              {highlight.fullWidth ? (
                <div class="highlight-card-content--full">
                  <div class="highlight-card-text">
                    <span class="highlight-card-title--large">
                      {highlight.title}
                    </span>
                    <span class="highlight-card-subtitle">
                      {highlight.subtitle}
                    </span>
                  </div>
                  <Icon name={highlight.icon} class="highlight-card-icon--large" />
                </div>
              ) : (
                <div class="highlight-card-content">
                  <Icon name={highlight.icon} class="highlight-card-icon" />
                  <h4 class="highlight-card-title">{highlight.title}</h4>
                  <p class="highlight-card-subtitle">{highlight.subtitle}</p>
                </div>
              )}
            </div>
          ))
        }
      </div>
    </div>

    <!-- Conteúdo -->
    <div class:list={["content-wrapper", { "order-2": imagePosition === "left", "order-1": imagePosition === "right" }]}>
      <div class="content-header">
        <div class="content-icon-wrapper">
          <Icon name={icon} class="content-icon" />
        </div>
        <h2 class="content-title">{title}</h2>
      </div>
      <p class="content-description">
        {description}
      </p>
      <div class="features-grid">
        {
          features.map((feature) => (
            <div class="feature-item">
              <Icon name={feature.icon} class="feature-icon" />
              <div>
                <h5 class="feature-title">{feature.title}</h5>
                <p class="feature-description">{feature.description}</p>
              </div>
            </div>
          ))
        }
      </div>
      <a href={ctaHref} class="cta-button">
        {ctaText}
        <Icon name="mdi:arrow-right" class="cta-icon" />
      </a>
    </div>
  </div>
</div>

<style>
  .service-detail-section {
    padding-bottom: 8rem;
    border-bottom: 1px solid rgba(42, 42, 42, 0.4);
    margin-bottom: 8rem;
  }

  .service-detail-section--last {
    border-bottom: none;
    margin-bottom: 0;
  }

  .service-detail-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 4rem;
    align-items: center;
  }

  @media (min-width: 1024px) {
    .service-detail-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  .order-1 {
    order: 1;
  }

  .order-2 {
    order: 2;
  }

  @media (min-width: 1024px) {
    .highlights-wrapper {
      order: unset;
    }

    .content-wrapper {
      order: unset;
    }
  }

  /* Destaques */
  .highlights-wrapper {
    position: relative;
  }

  .highlights-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--space-4);
  }

  .highlight-card {
    background-color: var(--surface-dark);
    padding: var(--space-6);
    border-radius: var(--radius-sm);
    border: 1px solid var(--border-dark);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
    transition: border-color var(--transition-base), transform var(--transition-base);
    height: 10rem;
  }

  .highlight-card:hover {
    border-color: var(--primary);
    transform: translateY(-0.25rem);
  }

  .highlight-card--full {
    grid-column: span 2;
    background-color: rgba(42, 42, 42, 0.5);
  }

  .highlight-card--full:hover {
    transform: none;
  }

  .highlight-card-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    width: 100%;
    height: 100%;
  }

  .highlight-card-content--full {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-between;
    padding: 0 var(--space-4);
    width: 100%;
  }

  .highlight-card-text {
    display: flex;
    flex-direction: column;
    text-align: left;
  }

  .highlight-card-icon {
    font-size: var(--text-4xl);
    color: var(--primary);
    margin-bottom: var(--space-3);
    transition: transform var(--transition-base);
  }

  .highlight-card-icon svg {
    width: 1em;
    height: 1em;
  }

  .highlight-card:hover .highlight-card-icon {
    transform: scale(1.1);
  }

  .highlight-card-icon--large {
    font-size: var(--text-5xl);
    color: var(--primary);
  }

  .highlight-card-icon--large svg {
    width: 1em;
    height: 1em;
  }

  .highlight-card-title {
    font-weight: var(--font-bold);
    color: var(--text-primary-dark);
    font-size: var(--text-lg);
  }

  .highlight-card-title--large {
    font-size: var(--text-3xl);
    font-weight: var(--font-bold);
    color: var(--text-primary-dark);
  }

  .highlight-card-subtitle {
    font-size: var(--text-xs);
    color: var(--text-secondary-dark);
    text-transform: uppercase;
    letter-spacing: var(--tracking-wider);
    margin-top: var(--space-1);
  }

  /* Conteúdo */
  .content-wrapper {
    display: flex;
    flex-direction: column;
  }

  .content-header {
    display: flex;
    align-items: center;
    gap: var(--space-3);
    margin-bottom: var(--space-6);
  }

  .content-icon-wrapper {
    padding: var(--space-3);
    background-color: var(--surface-dark);
    border-radius: var(--radius-sm);
    border: 1px solid var(--border-dark);
  }

  .content-icon {
    font-size: var(--text-3xl);
    color: var(--primary);
  }

  .content-icon svg {
    width: 1em;
    height: 1em;
  }

  .content-title {
    font-size: var(--text-3xl);
    font-weight: var(--font-bold);
    text-transform: uppercase;
    color: var(--text-primary-dark);
  }

  .content-description {
    color: var(--text-secondary-dark);
    margin-bottom: var(--space-8);
    line-height: var(--leading-relaxed);
    font-size: var(--text-lg);
  }

  .features-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: var(--space-4);
    margin-bottom: var(--space-8);
  }

  @media (min-width: 640px) {
    .features-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  .feature-item {
    display: flex;
    align-items: flex-start;
    gap: var(--space-3);
  }

  .feature-icon {
    color: var(--primary);
    margin-top: var(--space-1);
    font-size: var(--text-xl);
  }

  .feature-icon svg {
    width: 1em;
    height: 1em;
  }

  .feature-title {
    font-weight: var(--font-bold);
    color: var(--text-primary-dark);
    font-size: var(--text-sm);
    text-transform: uppercase;
    margin-bottom: var(--space-1);
  }

  .feature-description {
    font-size: var(--text-sm);
    color: var(--text-secondary-dark);
  }

  .cta-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: var(--space-3) var(--space-6);
    border: 1px solid var(--primary);
    color: var(--primary);
    font-weight: var(--font-bold);
    text-transform: uppercase;
    font-size: var(--text-sm);
    letter-spacing: var(--tracking-wider);
    border-radius: var(--radius-sm);
    position: relative;
    overflow: hidden;
    z-index: 1;
    transition: color 400ms ease;
  }

  .cta-button::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 0;
    height: 100%;
    background-color: var(--primary);
    transition: width 400ms cubic-bezier(0.4, 0, 0.2, 1);
    z-index: -1;
  }

  .cta-button:hover::before {
    width: 100%;
  }

  .cta-button:hover {
    color: var(--background-dark);
  }

  .cta-icon {
    margin-left: var(--space-2);
    font-size: var(--text-lg);
  }

  .cta-icon svg {
    width: 1em;
    height: 1em;
  }
</style>
